<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>MyBatis-plus | YUKIPEDIA's blog</title><meta name=keywords content><meta name=description content="MyBatis-plus - YUKIPEDIA's blog"><meta name=author content><link rel=canonical href=https://yukipedia.cn/notes/2024-11-19-mybatis-plus/><link crossorigin=anonymous href=../../assets/css/stylesheet.2211ca3164be7830024f6aad2b3a2e520843a64f8f048445c3401c1249aa051d.css integrity="sha256-IhHKMWS+eDACT2qtKzouUghDpk+PBIRFw0AcEkmqBR0=" rel="preload stylesheet" as=style><link rel=icon href=https://yukipedia.cn/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://yukipedia.cn/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://yukipedia.cn/favicon-32x32.png><link rel=apple-touch-icon href=https://yukipedia.cn/apple-touch-icon.png><link rel=mask-icon href=https://yukipedia.cn/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://yukipedia.cn/notes/2024-11-19-mybatis-plus/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://yukipedia.cn/notes/2024-11-19-mybatis-plus/"><meta property="og:site_name" content="YUKIPEDIA's blog"><meta property="og:title" content="MyBatis-plus"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="notes"><meta property="article:published_time" content="2024-11-19T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-19T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="MyBatis-plus"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://yukipedia.cn/notes/"},{"@type":"ListItem","position":2,"name":"MyBatis-plus","item":"https://yukipedia.cn/notes/2024-11-19-mybatis-plus/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"MyBatis-plus","name":"MyBatis-plus","description":"","keywords":[],"articleBody":"简介 MyBatis-Plus（简称 MP）是一个 MyBatis 的增强工具包，它在 MyBatis 的基础上进行了一些优化和提升，旨在简化开发，提高开发效率，减少冗余代码\n提升与特性 1.无侵入式增强 MyBatis-Plus 是在 MyBatis 基础上的增强，不需要修改现有 MyBatis 的配置和代码，最大程度地保持兼容性和灵活性。\n2.增强的 CRUD 操作 MyBatis-Plus 提供了内置的通用 Mapper 和 Service，开发者不再需要编写常见的增删改查（CRUD）方法。通过继承 BaseMapper 接口，开发者可以直接调用现成的方法来进行数据库操作。\n常见的 CRUD 方法：\ninsert() updateById() selectById() deleteById() selectList() selectOne() selectCount() 举个例子：\n假设有一个 User 实体类，包含用户信息的字段。\n@Data public class User { private Long id; private String name; private Integer age; private String email; } Mapper 接口：MyBatis-Plus 提供了 BaseMapper 接口，只需让自己的 Mapper 接口继承 BaseMapper，就能自动拥有常用的 CRUD 方法。\npublic interface UserMapper extends BaseMapper\u003cUser\u003e { // 你可以根据需要添加自定义的方法 } 插入操作： @Autowired private UserMapper userMapper; public void insertUser() { User user = new User(); user.setName(\"John\"); user.setAge(30); user.setEmail(\"john.doe@example.com\"); // 插入用户 userMapper.insert(user); } 注意： 插入时会自动返回 user 的主键值，如果数据库使用的是自增主键。\n根据 ID 更新：updateById() 方法用于根据 id 更新某条记录。 public void updateUserById() { User user = new User(); user.setId(1L); // 更新 ID 为 1 的用户 user.setAge(31); // 更新年龄为 31 // 根据 id 更新记录 userMapper.updateById(user); } 根据 ID 查询：selectById() 方法根据 id 查询单条记录。 public void selectUserById() { Long userId = 1L; // 根据 id 查询用户 User user = userMapper.selectById(userId); System.out.println(user); } 查询所有记录：selectList() 方法可以查询所有记录，当然也可以通过 QueryWrapper 对查询条件进行过滤。 public void selectAllUsers() { // 查询所有用户 List\u003cUser\u003e users = userMapper.selectList(null); // 传 null 表示不加查询条件 users.forEach(System.out::println); } 条件查询：使用 QueryWrapper 来构建查询条件。以下示例查询年龄大于 18 且名字为 “John” 的用户。 public void selectUsersByCondition() { QueryWrapper\u003cUser\u003e wrapper = new QueryWrapper\u003c\u003e(); wrapper.gt(\"age\", 18) // 年龄大于 18 .eq(\"name\", \"John\"); // 名字为 \"John\" List\u003cUser\u003e users = userMapper.selectList(wrapper); users.forEach(System.out::println); } 删除操作：deleteById() 方法根据 ID 删除记录。 public void deleteUserById() { Long userId = 1L; // 根据 ID 删除用户 userMapper.deleteById(userId); } 批量插入：insertBatchSomeColumn() 方法用于批量插入数据。注意，这个方法是 MyBatis-Plus 在 3.x 版本后才引入的，如果需要批量插入，可以使用该方法。 public void insertBatchUsers() { List\u003cUser\u003e users = new ArrayList\u003c\u003e(); users.add(new User(null, \"Alice\", 25, \"alice@example.com\")); users.add(new User(null, \"Bob\", 28, \"bob@example.com\")); // 批量插入用户 userMapper.insertBatchSomeColumn(users); } 分页查询：MyBatis-Plus 提供了分页查询支持，通过 Page 对象来进行分页查询。 public void selectUsersByPage() { // 当前页和每页条数 Page\u003cUser\u003e page = new Page\u003c\u003e(1, 10); // 第1页，每页10条 // 进行分页查询 Page\u003cUser\u003e userPage = userMapper.selectPage(page, null); // 获取分页结果 List\u003cUser\u003e users = userPage.getRecords(); users.forEach(System.out::println); // 获取分页信息 long total = userPage.getTotal(); // 总记录数 System.out.println(\"Total users: \" + total); } 逻辑删除：MyBatis-Plus 支持逻辑删除，通过在实体类中使用 @TableLogic 注解，MyBatis-Plus 将自动进行逻辑删除，而不是物理删除。 @Data public class User { private Long id; private String name; private Integer age; private String email; @TableLogic private Integer deleted; // 逻辑删除字段 } 使用 deleteById() 时，默认会根据 @TableLogic 注解标记的字段进行逻辑删除。\npublic void deleteUserLogic() { Long userId = 1L; // 执行逻辑删除 userMapper.deleteById(userId); } 3.条件构造器（Wrapper） MyBatis-Plus 提供了 QueryWrapper 和 UpdateWrapper 类，用于构建查询条件和更新条件。条件构造器支持链式调用，开发者可以更直观地构建查询和更新条件，减少了手动拼接 SQL 的复杂度。\nQueryWrapper\u003cUser\u003e wrapper = new QueryWrapper\u003c\u003e(); wrapper.eq(\"age\", 25).lt(\"score\", 100); List\u003cUser\u003e users = userMapper.selectList(wrapper); QueryWrapper 是用于查询的条件构造器，支持多种条件查询，允许通过链式调用来添加各种查询条件。\n构建查询方法 常用方法\neq()：等于 ne()：不等于 gt()：大于 lt()：小于 ge()：大于等于 le()：小于等于 like()：模糊匹配 between()：区间查询 in()：集合查询 isNull()：为空 orderByAsc() / orderByDesc()：排序 groupBy()：分组 or()：逻辑 OR 条件 likeLeft()：左模糊匹配 likeRight()：右模糊匹配 示例\n假设我们有一个 User 实体类，包含 id, name, age, 和 email 字段\n// 实体类 @Data public class User { private Long id; private String name; private Integer age; private String email; } 查询年龄大于30且名字为\"John\"的用户\nQueryWrapper\u003cUser\u003e queryWrapper = new QueryWrapper\u003c\u003e(); queryWrapper.gt(\"age\", 30) // 年龄大于30 .eq(\"name\", \"John\"); // 名字为\"John\" // 执行查询 List\u003cUser\u003e users = userMapper.selectList(queryWrapper); users.forEach(System.out::println); 模糊查询名字包含\"Jo\"且邮箱为特定值\nQueryWrapper\u003cUser\u003e queryWrapper = new QueryWrapper\u003c\u003e(); queryWrapper.like(\"name\", \"Jo\") // 名字包含\"Jo\" .eq(\"email\", \"john.doe@example.com\"); // 邮箱为特定值 // 执行查询 List\u003cUser\u003e users = userMapper.selectList(queryWrapper); users.forEach(System.out::println); 查询年龄在25到30岁之间的用户\nQueryWrapper\u003cUser\u003e queryWrapper = new QueryWrapper\u003c\u003e(); queryWrapper.between(\"age\", 25, 30); // 年龄在25到30之间 // 执行查询 List\u003cUser\u003e users = userMapper.selectList(queryWrapper); users.forEach(System.out::println); 查询名字为\"John\"或\"Jane\"的用户\nQueryWrapper\u003cUser\u003e queryWrapper = new QueryWrapper\u003c\u003e(); queryWrapper.in(\"name\", \"John\", \"Jane\"); // 名字为\"John\"或\"Jane\" // 执行查询 List\u003cUser\u003e users = userMapper.selectList(queryWrapper); users.forEach(System.out::println); 查询年龄大于30，并按年龄升序排序\nQueryWrapper\u003cUser\u003e queryWrapper = new QueryWrapper\u003c\u003e(); queryWrapper.gt(\"age\", 30) // 年龄大于30 .orderByAsc(\"age\"); // 按年龄升序排序 // 执行查询 List\u003cUser\u003e users = userMapper.selectList(queryWrapper); users.forEach(System.out::println); 构建更新条件 常用方法\nset()：设置更新的字段值 eq()：等于 ne()：不等于 gt()：大于 lt()：小于 ge()：大于等于 le()：小于等于 like()：模糊匹配 isNull()：为空 in()：集合查询 更新名字为\"John\"的用户的年龄为35\nUpdateWrapper\u003cUser\u003e updateWrapper = new UpdateWrapper\u003c\u003e(); updateWrapper.eq(\"name\", \"John\") // 条件：名字为\"John\" .set(\"age\", 35); // 更新：将年龄设置为35 // 执行更新 userMapper.update(null, updateWrapper); // 第一个参数为null表示不更新实体类中的数据 批量更新多个用户的邮箱\nUpdateWrapper\u003cUser\u003e updateWrapper = new UpdateWrapper\u003c\u003e(); updateWrapper.in(\"id\", 1L, 2L, 3L) // 条件：id为1, 2, 3 .set(\"email\", \"new.email@example.com\"); // 更新邮箱 // 执行更新 userMapper.update(null, updateWrapper); 将年龄大于30的用户的状态更新为\"已成年\"\nUpdateWrapper\u003cUser\u003e updateWrapper = new UpdateWrapper\u003c\u003e(); updateWrapper.gt(\"age\", 30) // 条件：年龄大于30 .set(\"status\", \"已成年\"); // 更新：将状态设置为\"已成年\" // 执行更新 userMapper.update(null, updateWrapper); 组合条件查询 在 MyBatis-Plus 中，QueryWrapper 和 UpdateWrapper 支持灵活的逻辑组合条件（如 AND、OR、NOT）。使用 and()、or()、nor() 等方法，可以实现更复杂的查询。\n查询条件的 AND 组合\nQueryWrapper\u003cUser\u003e queryWrapper = new QueryWrapper\u003c\u003e(); queryWrapper.eq(\"name\", \"John\") // 名字为\"John\" .and(wrapper -\u003e wrapper.lt(\"age\", 30).or().gt(\"age\", 40)); // 年龄小于30或大于40 // 执行查询 List\u003cUser\u003e users = userMapper.selectList(queryWrapper); users.forEach(System.out::println); 查询条件的 OR 组合\nQueryWrapper\u003cUser\u003e queryWrapper = new QueryWrapper\u003c\u003e(); queryWrapper.eq(\"name\", \"John\") // 名字为\"John\" .or().eq(\"name\", \"Jane\"); // 或者名字为\"Jane\" // 执行查询 List\u003cUser\u003e users = userMapper.selectList(queryWrapper); users.forEach(System.out::println); 4.分页查询 MyBatis-Plus 内置了分页插件，使得分页查询更加简单。通过配置分页插件，可以直接使用 Page 对象来进行分页查询。\nPage\u003cUser\u003e page = new Page\u003c\u003e(1, 10); // 第1页，每页10条 Page\u003cUser\u003e userPage = userMapper.selectPage(page, null); 5.自动填充功能 MyBatis-Plus 支持字段的自动填充，例如在插入或更新时自动填充某些字段的值（如创建时间、修改时间等）。通过实现 MetaObjectHandler 接口来配置自动填充逻辑。\npublic class MyMetaObjectHandler implements MetaObjectHandler { @Override public void insertFill(MetaObject metaObject) { // 插入时自动填充字段 \"createTime\"，值为当前时间 this.setFieldValByName(\"createTime\", new Date(), metaObject); } @Override public void updateFill(MetaObject metaObject) { // 更新时自动填充字段 \"updateTime\"，值为当前时间 this.setFieldValByName(\"updateTime\", new Date(), metaObject); } } 自动填充的工作原理\n当 MyBatis-Plus 执行插入（insert()）或更新（update()）操作时，会先检查实体类中是否有需要自动填充的字段。通常，这些字段是一些例如 createTime（创建时间）和 updateTime（更新时间）等字段。 在 insert() 操作时，insertFill() 方法会被调用，允许你在插入数据之前设置需要填充的字段（如设置 createTime 字段为当前时间）。 在 update() 操作时，updateFill() 方法会被调用，允许你在更新数据时自动填充某些字段（如设置 updateTime 字段为当前时间）。 以上面的代码为例：\ninsertFill(MetaObject metaObject) 方法 metaObject 参数是 MyBatis-Plus 用来封装实体类的对象，它提供了对实体类字段的访问接口。通过 setFieldValByName() 方法设置实体类中某个字段的值。 setFieldValByName(\"createTime\", new Date(), metaObject) 这行代码的作用是：通过反射机制，自动将实体类中 createTime 字段的值设置为当前的日期和时间（new Date()）。 updateFill(MetaObject metaObject) 方法 metaObject 参数同样用于封装实体类的对象，通过 setFieldValByName() 方法来设置字段值。 setFieldValByName(\"updateTime\", new Date(), metaObject) ：通过反射机制，自动将实体类中 updateTime 字段的值设置为当前的日期和时间（new Date()）。 6.乐观锁插件 MyBatis-Plus 提供了乐观锁插件，通过在实体类中添加版本号字段（如 version），并在数据库操作时自动校验版本号，从而实现对数据并发操作的控制。\n@Version private Integer version; 7.代码生成器 MyBatis-Plus 提供了强大的代码生成器，可以根据数据库表结构自动生成实体类、Mapper 接口、Mapper XML 文件、Service 类等，极大提高了开发效率，避免了重复造轮子。\n8.自定义 SQL 支持 虽然 MyBatis-Plus 提供了很多通用的操作，但如果需要自定义复杂的 SQL 查询或操作，仍然可以通过 @Select、@Update 等注解来编写 SQL，也可以直接使用 MyBatis 的原生方式。\n9.性能分析 MyBatis-Plus 提供了 SQL 性能分析插件，可以在开发阶段输出 SQL 语句和执行时间，帮助开发者发现性能瓶颈，优化查询。\n10.分库分表支持（Sharding） MyBatis-Plus 提供了对分库分表的支持，方便进行水平拆分和数据库分布式管理。\n分库分表 是数据库水平扩展（sharding）的一种常见技术，目的是通过将数据分散到多个数据库或表中，以提高数据库的性能、可扩展性和容错能力。在大型分布式系统中，单一数据库可能面临性能瓶颈或者数据量过大导致无法处理的情况，分库分表通过将数据切分成多个部分，分散到多个存储单元中，解决了这些问题。\n11.补充 先看下面两段代码\nUser user = query().eq(\"phone\", phone).one(); List\u003cBlog\u003e blogs = query().in(\"id\", ids).last(\"ORDER BY FIELD(id,\" + idStr + \")\").list(); 虽然这两段代码调用了 query() 方法，但是 它们查询的是不同的数据库表，这主要是通过 query() 方法所在的服务类 来决定的。\nquery() 方法所在的服务类 在 MyBatis-Plus 中，query() 方法是 IService 接口中的一个默认方法，它实际上是通过 BaseMapper 执行数据库查询操作。因此，query() 方法是基于当前实例的 BaseMapper 来执行查询的。不同的服务类会使用不同的实体类和 BaseMapper，从而查询不同的数据库表。\nUser user = query().eq(\"phone\", phone).one(); 假设 query() 方法是 UserService 类中的方法，这时 UserService 会注入 UserMapper，而 UserMapper 是与 user 表进行交互的。 在 query() 方法调用时，BaseMapper（这里是 UserMapper）会执行对应 user 表的查询。 List blogs = query().in(\"id\", ids).last(\"ORDER BY FIELD(id,\" + idStr + \")\").list(); 同样，假设这行代码是在 BlogService 类中调用的 query()，那么此时 query() 返回的就是与 Blog 实体相关联的 BlogMapper。 BlogMapper 会执行对 blog 表的查询。 BaseMapper 和 query() 方法的关联 每个实体类（如 User、Blog）通常会有一个对应的 Mapper，该 Mapper 是通过 BaseMapper 进行扩展的，它提供了常用的 CRUD 操作。而 IService 接口中的 query() 方法依赖于 BaseMapper 来执行实际的查询操作。\nBaseMapper：提供了常用的数据库操作方法，例如 selectList(), selectOne(), selectById() 等。 query() 方法：返回一个 QueryChainWrapper，用于构建查询条件，最终会调用对应的 BaseMapper（如 UserMapper 或 BlogMapper）执行查询。 如何判断查询哪个数据库？ MyBatis-Plus 在执行查询时是通过 BaseMapper 来决定的，具体如下：\nUserService 类： 如果 query() 方法在 UserService 中被调用，那么 UserService 的 BaseMapper 就是 UserMapper，UserMapper 与 user 表对应，查询将发生在 user 表中。 这里的 query() 方法调用的是 UserMapper 的方法。 BlogService 类： 如果 query() 方法在 BlogService 中被调用，那么 BlogService 的 BaseMapper 就是 BlogMapper，BlogMapper 与 blog 表对应，查询将发生在 blog 表中。 这里的 query() 方法调用的是 BlogMapper 的方法。 每个服务类（如 UserService、BlogService）都具有自己的 BaseMapper，而 BaseMapper 的 selectList()、selectOne() 等方法会查询不同的数据库表。\n","wordCount":"973","inLanguage":"en","datePublished":"2024-11-19T00:00:00Z","dateModified":"2024-11-19T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://yukipedia.cn/notes/2024-11-19-mybatis-plus/"},"publisher":{"@type":"Organization","name":"YUKIPEDIA's blog","logo":{"@type":"ImageObject","url":"https://yukipedia.cn/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://yukipedia.cn/ accesskey=h title="YUKIPEDIA's blog (Alt + H)">YUKIPEDIA's blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://yukipedia.cn/about title="About me?"><span>About me?</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">MyBatis-plus</h1><div class=post-meta><span title='2024-11-19 00:00:00 +0000 UTC'>November 19, 2024</span></div></header><div class=post-content><h2 id=简介>简介<a hidden class=anchor aria-hidden=true href=#简介>#</a></h2><p>MyBatis-Plus（简称 MP）是一个 MyBatis 的增强工具包，它在 MyBatis 的基础上进行了一些优化和提升，旨在简化开发，提高开发效率，减少冗余代码</p><h2 id=提升与特性>提升与特性<a hidden class=anchor aria-hidden=true href=#提升与特性>#</a></h2><h3 id=1无侵入式增强>1.无侵入式增强<a hidden class=anchor aria-hidden=true href=#1无侵入式增强>#</a></h3><p>MyBatis-Plus 是在 MyBatis 基础上的增强，不需要修改现有 MyBatis 的配置和代码，最大程度地保持兼容性和灵活性。</p><h3 id=2增强的-crud-操作>2.增强的 CRUD 操作<a hidden class=anchor aria-hidden=true href=#2增强的-crud-操作>#</a></h3><p>MyBatis-Plus 提供了内置的通用 Mapper 和 Service，开发者不再需要编写常见的增删改查（CRUD）方法。通过继承 <code>BaseMapper</code> 接口，开发者可以直接调用现成的方法来进行数据库操作。</p><p><strong>常见的 CRUD 方法：</strong></p><ul><li><code>insert()</code></li><li><code>updateById()</code></li><li><code>selectById()</code></li><li><code>deleteById()</code></li><li><code>selectList()</code></li><li><code>selectOne()</code></li><li><code>selectCount()</code></li></ul><p>举个例子：</p><p>假设有一个 <code>User</code> 实体类，包含用户信息的字段。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Long id;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer age;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String email;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>Mapper</code> 接口：MyBatis-Plus 提供了 <code>BaseMapper</code> 接口，只需让自己的 <code>Mapper</code> 接口继承 <code>BaseMapper</code>，就能自动拥有常用的 CRUD 方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>UserMapper</span> <span style=color:#66d9ef>extends</span> BaseMapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 你可以根据需要添加自定义的方法</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol><li>插入操作：</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Autowired</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> UserMapper userMapper;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insertUser</span>() {
</span></span><span style=display:flex><span>    User user <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User();
</span></span><span style=display:flex><span>    user.<span style=color:#a6e22e>setName</span>(<span style=color:#e6db74>&#34;John&#34;</span>);
</span></span><span style=display:flex><span>    user.<span style=color:#a6e22e>setAge</span>(30);
</span></span><span style=display:flex><span>    user.<span style=color:#a6e22e>setEmail</span>(<span style=color:#e6db74>&#34;john.doe@example.com&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 插入用户</span>
</span></span><span style=display:flex><span>    userMapper.<span style=color:#a6e22e>insert</span>(user);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>注意：</strong> 插入时会自动返回 <code>user</code> 的主键值，如果数据库使用的是自增主键。</p><ol start=2><li>根据 ID 更新：<code>updateById()</code> 方法用于根据 <code>id</code> 更新某条记录。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>updateUserById</span>() {
</span></span><span style=display:flex><span>    User user <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> User();
</span></span><span style=display:flex><span>    user.<span style=color:#a6e22e>setId</span>(1L);  <span style=color:#75715e>// 更新 ID 为 1 的用户</span>
</span></span><span style=display:flex><span>    user.<span style=color:#a6e22e>setAge</span>(31);  <span style=color:#75715e>// 更新年龄为 31</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 根据 id 更新记录</span>
</span></span><span style=display:flex><span>    userMapper.<span style=color:#a6e22e>updateById</span>(user);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=3><li>根据 ID 查询：<code>selectById()</code> 方法根据 <code>id</code> 查询单条记录。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>selectUserById</span>() {
</span></span><span style=display:flex><span>    Long userId <span style=color:#f92672>=</span> 1L;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 根据 id 查询用户</span>
</span></span><span style=display:flex><span>    User user <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectById</span>(userId);
</span></span><span style=display:flex><span>    System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(user);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=4><li>查询所有记录：<code>selectList()</code> 方法可以查询所有记录，当然也可以通过 <code>QueryWrapper</code> 对查询条件进行过滤。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>selectAllUsers</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 查询所有用户</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(<span style=color:#66d9ef>null</span>);  <span style=color:#75715e>// 传 null 表示不加查询条件</span>
</span></span><span style=display:flex><span>    users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=5><li>条件查询：使用 <code>QueryWrapper</code> 来构建查询条件。以下示例查询年龄大于 18 且名字为 &ldquo;John&rdquo; 的用户。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>selectUsersByCondition</span>() {
</span></span><span style=display:flex><span>    QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> wrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>    wrapper.<span style=color:#a6e22e>gt</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 18)  <span style=color:#75715e>// 年龄大于 18</span>
</span></span><span style=display:flex><span>           .<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;John&#34;</span>);  <span style=color:#75715e>// 名字为 &#34;John&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(wrapper);
</span></span><span style=display:flex><span>    users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=6><li>删除操作：<code>deleteById()</code> 方法根据 ID 删除记录。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>deleteUserById</span>() {
</span></span><span style=display:flex><span>    Long userId <span style=color:#f92672>=</span> 1L;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 根据 ID 删除用户</span>
</span></span><span style=display:flex><span>    userMapper.<span style=color:#a6e22e>deleteById</span>(userId);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=7><li>批量插入：<code>insertBatchSomeColumn()</code> 方法用于批量插入数据。注意，这个方法是 MyBatis-Plus 在 3.x 版本后才引入的，如果需要批量插入，可以使用该方法。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insertBatchUsers</span>() {
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> ArrayList<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    users.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> User(<span style=color:#66d9ef>null</span>, <span style=color:#e6db74>&#34;Alice&#34;</span>, 25, <span style=color:#e6db74>&#34;alice@example.com&#34;</span>));
</span></span><span style=display:flex><span>    users.<span style=color:#a6e22e>add</span>(<span style=color:#66d9ef>new</span> User(<span style=color:#66d9ef>null</span>, <span style=color:#e6db74>&#34;Bob&#34;</span>, 28, <span style=color:#e6db74>&#34;bob@example.com&#34;</span>));
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 批量插入用户</span>
</span></span><span style=display:flex><span>    userMapper.<span style=color:#a6e22e>insertBatchSomeColumn</span>(users);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=8><li>分页查询：MyBatis-Plus 提供了分页查询支持，通过 <code>Page</code> 对象来进行分页查询。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>selectUsersByPage</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 当前页和每页条数</span>
</span></span><span style=display:flex><span>    Page<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> page <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Page<span style=color:#f92672>&lt;&gt;</span>(1, 10);  <span style=color:#75715e>// 第1页，每页10条</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 进行分页查询</span>
</span></span><span style=display:flex><span>    Page<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> userPage <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectPage</span>(page, <span style=color:#66d9ef>null</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取分页结果</span>
</span></span><span style=display:flex><span>    List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userPage.<span style=color:#a6e22e>getRecords</span>();
</span></span><span style=display:flex><span>    users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取分页信息</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>long</span> total <span style=color:#f92672>=</span> userPage.<span style=color:#a6e22e>getTotal</span>();  <span style=color:#75715e>// 总记录数</span>
</span></span><span style=display:flex><span>    System.<span style=color:#a6e22e>out</span>.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Total users: &#34;</span> <span style=color:#f92672>+</span> total);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ol start=9><li>逻辑删除：MyBatis-Plus 支持逻辑删除，通过在实体类中使用 <code>@TableLogic</code> 注解，MyBatis-Plus 将自动进行逻辑删除，而不是物理删除。</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Long id;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer age;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String email;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@TableLogic</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer deleted;  <span style=color:#75715e>// 逻辑删除字段</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>使用 <code>deleteById()</code> 时，默认会根据 <code>@TableLogic</code> 注解标记的字段进行逻辑删除。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>deleteUserLogic</span>() {
</span></span><span style=display:flex><span>    Long userId <span style=color:#f92672>=</span> 1L;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 执行逻辑删除</span>
</span></span><span style=display:flex><span>    userMapper.<span style=color:#a6e22e>deleteById</span>(userId);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=3条件构造器wrapper>3.条件构造器（Wrapper）<a hidden class=anchor aria-hidden=true href=#3条件构造器wrapper>#</a></h3><p>MyBatis-Plus 提供了 <code>QueryWrapper</code> 和 <code>UpdateWrapper</code> 类，用于构建查询条件和更新条件。条件构造器支持链式调用，开发者可以更直观地构建查询和更新条件，减少了手动拼接 SQL 的复杂度。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> wrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>wrapper.<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 25).<span style=color:#a6e22e>lt</span>(<span style=color:#e6db74>&#34;score&#34;</span>, 100);
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(wrapper);
</span></span></code></pre></div><p><code>QueryWrapper</code> 是用于查询的条件构造器，支持多种条件查询，允许通过链式调用来添加各种查询条件。</p><ol><li>构建查询方法</li></ol><p><strong>常用方法</strong></p><ul><li><code>eq()</code>：等于</li><li><code>ne()</code>：不等于</li><li><code>gt()</code>：大于</li><li><code>lt()</code>：小于</li><li><code>ge()</code>：大于等于</li><li><code>le()</code>：小于等于</li><li><code>like()</code>：模糊匹配</li><li><code>between()</code>：区间查询</li><li><code>in()</code>：集合查询</li><li><code>isNull()</code>：为空</li><li><code>orderByAsc()</code> / <code>orderByDesc()</code>：排序</li><li><code>groupBy()</code>：分组</li><li><code>or()</code>：逻辑 OR 条件</li><li><code>likeLeft()</code>：左模糊匹配</li><li><code>likeRight()</code>：右模糊匹配</li></ul><p><strong>示例</strong></p><p>假设我们有一个 <code>User</code> 实体类，包含 <code>id</code>, <code>name</code>, <code>age</code>, 和 <code>email</code> 字段</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#75715e>// 实体类</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>@Data</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>User</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Long id;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String name;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> Integer age;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> String email;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>查询年龄大于30且名字为"John"的用户</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> queryWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>queryWrapper.<span style=color:#a6e22e>gt</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 30)  <span style=color:#75715e>// 年龄大于30</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;John&#34;</span>);  <span style=color:#75715e>// 名字为&#34;John&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行查询</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(queryWrapper);
</span></span><span style=display:flex><span>users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span></code></pre></div><p><strong>模糊查询名字包含"Jo"且邮箱为特定值</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> queryWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>queryWrapper.<span style=color:#a6e22e>like</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;Jo&#34;</span>)  <span style=color:#75715e>// 名字包含&#34;Jo&#34;</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;email&#34;</span>, <span style=color:#e6db74>&#34;john.doe@example.com&#34;</span>);  <span style=color:#75715e>// 邮箱为特定值</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行查询</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(queryWrapper);
</span></span><span style=display:flex><span>users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span></code></pre></div><p><strong>查询年龄在25到30岁之间的用户</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> queryWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>queryWrapper.<span style=color:#a6e22e>between</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 25, 30);  <span style=color:#75715e>// 年龄在25到30之间</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行查询</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(queryWrapper);
</span></span><span style=display:flex><span>users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span></code></pre></div><p><strong>查询名字为"John"或"Jane"的用户</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> queryWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>queryWrapper.<span style=color:#a6e22e>in</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;John&#34;</span>, <span style=color:#e6db74>&#34;Jane&#34;</span>);  <span style=color:#75715e>// 名字为&#34;John&#34;或&#34;Jane&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行查询</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(queryWrapper);
</span></span><span style=display:flex><span>users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span></code></pre></div><p><strong>查询年龄大于30，并按年龄升序排序</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> queryWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>queryWrapper.<span style=color:#a6e22e>gt</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 30)  <span style=color:#75715e>// 年龄大于30</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>orderByAsc</span>(<span style=color:#e6db74>&#34;age&#34;</span>);  <span style=color:#75715e>// 按年龄升序排序</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行查询</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(queryWrapper);
</span></span><span style=display:flex><span>users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span></code></pre></div><ol start=2><li>构建更新条件</li></ol><p><strong>常用方法</strong></p><ul><li><code>set()</code>：设置更新的字段值</li><li><code>eq()</code>：等于</li><li><code>ne()</code>：不等于</li><li><code>gt()</code>：大于</li><li><code>lt()</code>：小于</li><li><code>ge()</code>：大于等于</li><li><code>le()</code>：小于等于</li><li><code>like()</code>：模糊匹配</li><li><code>isNull()</code>：为空</li><li><code>in()</code>：集合查询</li></ul><p><strong>更新名字为"John"的用户的年龄为35</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>UpdateWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> updateWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> UpdateWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>updateWrapper.<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;John&#34;</span>)  <span style=color:#75715e>// 条件：名字为&#34;John&#34;</span>
</span></span><span style=display:flex><span>             .<span style=color:#a6e22e>set</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 35);  <span style=color:#75715e>// 更新：将年龄设置为35</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行更新</span>
</span></span><span style=display:flex><span>userMapper.<span style=color:#a6e22e>update</span>(<span style=color:#66d9ef>null</span>, updateWrapper);  <span style=color:#75715e>// 第一个参数为null表示不更新实体类中的数据</span>
</span></span></code></pre></div><p><strong>批量更新多个用户的邮箱</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>UpdateWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> updateWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> UpdateWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>updateWrapper.<span style=color:#a6e22e>in</span>(<span style=color:#e6db74>&#34;id&#34;</span>, 1L, 2L, 3L)  <span style=color:#75715e>// 条件：id为1, 2, 3</span>
</span></span><span style=display:flex><span>             .<span style=color:#a6e22e>set</span>(<span style=color:#e6db74>&#34;email&#34;</span>, <span style=color:#e6db74>&#34;new.email@example.com&#34;</span>);  <span style=color:#75715e>// 更新邮箱</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行更新</span>
</span></span><span style=display:flex><span>userMapper.<span style=color:#a6e22e>update</span>(<span style=color:#66d9ef>null</span>, updateWrapper);
</span></span></code></pre></div><p><strong>将年龄大于30的用户的状态更新为"已成年"</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>UpdateWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> updateWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> UpdateWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>updateWrapper.<span style=color:#a6e22e>gt</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 30)  <span style=color:#75715e>// 条件：年龄大于30</span>
</span></span><span style=display:flex><span>             .<span style=color:#a6e22e>set</span>(<span style=color:#e6db74>&#34;status&#34;</span>, <span style=color:#e6db74>&#34;已成年&#34;</span>);  <span style=color:#75715e>// 更新：将状态设置为&#34;已成年&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行更新</span>
</span></span><span style=display:flex><span>userMapper.<span style=color:#a6e22e>update</span>(<span style=color:#66d9ef>null</span>, updateWrapper);
</span></span></code></pre></div><ol start=3><li>组合条件查询</li></ol><p>在 MyBatis-Plus 中，<code>QueryWrapper</code> 和 <code>UpdateWrapper</code> 支持灵活的逻辑组合条件（如 AND、OR、NOT）。使用 <code>and()</code>、<code>or()</code>、<code>nor()</code> 等方法，可以实现更复杂的查询。</p><p><strong>查询条件的 AND 组合</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> queryWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>queryWrapper.<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;John&#34;</span>)  <span style=color:#75715e>// 名字为&#34;John&#34;</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>and</span>(wrapper <span style=color:#f92672>-&gt;</span> wrapper.<span style=color:#a6e22e>lt</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 30).<span style=color:#a6e22e>or</span>().<span style=color:#a6e22e>gt</span>(<span style=color:#e6db74>&#34;age&#34;</span>, 40));  <span style=color:#75715e>// 年龄小于30或大于40</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行查询</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(queryWrapper);
</span></span><span style=display:flex><span>users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span></code></pre></div><p><strong>查询条件的 OR 组合</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>QueryWrapper<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> queryWrapper <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> QueryWrapper<span style=color:#f92672>&lt;&gt;</span>();
</span></span><span style=display:flex><span>queryWrapper.<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;John&#34;</span>)  <span style=color:#75715e>// 名字为&#34;John&#34;</span>
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>or</span>().<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;name&#34;</span>, <span style=color:#e6db74>&#34;Jane&#34;</span>);  <span style=color:#75715e>// 或者名字为&#34;Jane&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 执行查询</span>
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> users <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectList</span>(queryWrapper);
</span></span><span style=display:flex><span>users.<span style=color:#a6e22e>forEach</span>(System.<span style=color:#a6e22e>out</span>::println);
</span></span></code></pre></div><h3 id=4分页查询>4.分页查询<a hidden class=anchor aria-hidden=true href=#4分页查询>#</a></h3><p>MyBatis-Plus 内置了分页插件，使得分页查询更加简单。通过配置分页插件，可以直接使用 <code>Page</code> 对象来进行分页查询。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Page<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> page <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Page<span style=color:#f92672>&lt;&gt;</span>(1, 10);  <span style=color:#75715e>// 第1页，每页10条</span>
</span></span><span style=display:flex><span>Page<span style=color:#f92672>&lt;</span>User<span style=color:#f92672>&gt;</span> userPage <span style=color:#f92672>=</span> userMapper.<span style=color:#a6e22e>selectPage</span>(page, <span style=color:#66d9ef>null</span>);
</span></span></code></pre></div><h3 id=5自动填充功能>5.自动填充功能<a hidden class=anchor aria-hidden=true href=#5自动填充功能>#</a></h3><p>MyBatis-Plus 支持字段的自动填充，例如在插入或更新时自动填充某些字段的值（如创建时间、修改时间等）。通过实现 <code>MetaObjectHandler</code> 接口来配置自动填充逻辑。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyMetaObjectHandler</span> <span style=color:#66d9ef>implements</span> MetaObjectHandler {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>insertFill</span>(MetaObject metaObject) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 插入时自动填充字段 &#34;createTime&#34;，值为当前时间</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setFieldValByName</span>(<span style=color:#e6db74>&#34;createTime&#34;</span>, <span style=color:#66d9ef>new</span> Date(), metaObject);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@Override</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>updateFill</span>(MetaObject metaObject) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 更新时自动填充字段 &#34;updateTime&#34;，值为当前时间</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setFieldValByName</span>(<span style=color:#e6db74>&#34;updateTime&#34;</span>, <span style=color:#66d9ef>new</span> Date(), metaObject);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><strong>自动填充的工作原理</strong></p><ul><li>当 MyBatis-Plus 执行插入（<code>insert()</code>）或更新（<code>update()</code>）操作时，会先检查实体类中是否有需要自动填充的字段。通常，这些字段是一些例如 <code>createTime</code>（创建时间）和 <code>updateTime</code>（更新时间）等字段。</li><li>在 <code>insert()</code> 操作时，<code>insertFill()</code> 方法会被调用，允许你在插入数据之前设置需要填充的字段（如设置 <code>createTime</code> 字段为当前时间）。</li><li>在 <code>update()</code> 操作时，<code>updateFill()</code> 方法会被调用，允许你在更新数据时自动填充某些字段（如设置 <code>updateTime</code> 字段为当前时间）。</li></ul><p>以上面的代码为例：</p><ul><li><code>insertFill(MetaObject metaObject)</code> 方法<ul><li><code>metaObject</code> 参数是 MyBatis-Plus 用来封装实体类的对象，它提供了对实体类字段的访问接口。通过 <code>setFieldValByName()</code> 方法设置实体类中某个字段的值。</li><li><code>setFieldValByName("createTime", new Date(), metaObject)</code> 这行代码的作用是：通过<strong>反射机制</strong>，自动将实体类中 <code>createTime</code> 字段的值设置为当前的日期和时间（<code>new Date()</code>）。</li></ul></li><li><code>updateFill(MetaObject metaObject)</code> 方法<ul><li><code>metaObject</code> 参数同样用于封装实体类的对象，通过 <code>setFieldValByName()</code> 方法来设置字段值。</li><li><code>setFieldValByName("updateTime", new Date(), metaObject)</code> ：通过反射机制，自动将实体类中 <code>updateTime</code> 字段的值设置为当前的日期和时间（<code>new Date()</code>）。</li></ul></li></ul><h3 id=6乐观锁插件>6.乐观锁插件<a hidden class=anchor aria-hidden=true href=#6乐观锁插件>#</a></h3><p>MyBatis-Plus 提供了乐观锁插件，通过在实体类中添加版本号字段（如 <code>version</code>），并在数据库操作时自动校验版本号，从而实现对数据并发操作的控制。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#a6e22e>@Version</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>private</span> Integer version;
</span></span></code></pre></div><h3 id=7代码生成器>7.代码生成器<a hidden class=anchor aria-hidden=true href=#7代码生成器>#</a></h3><p>MyBatis-Plus 提供了强大的代码生成器，可以根据数据库表结构自动生成实体类、Mapper 接口、Mapper XML 文件、Service 类等，极大提高了开发效率，避免了重复造轮子。</p><h3 id=8自定义-sql-支持>8.自定义 SQL 支持<a hidden class=anchor aria-hidden=true href=#8自定义-sql-支持>#</a></h3><p>虽然 MyBatis-Plus 提供了很多通用的操作，但如果需要自定义复杂的 SQL 查询或操作，仍然可以通过 <code>@Select</code>、<code>@Update</code> 等注解来编写 SQL，也可以直接使用 MyBatis 的原生方式。</p><h3 id=9性能分析>9.性能分析<a hidden class=anchor aria-hidden=true href=#9性能分析>#</a></h3><p>MyBatis-Plus 提供了 SQL 性能分析插件，可以在开发阶段输出 SQL 语句和执行时间，帮助开发者发现性能瓶颈，优化查询。</p><h3 id=10分库分表支持sharding>10.分库分表支持（Sharding）<a hidden class=anchor aria-hidden=true href=#10分库分表支持sharding>#</a></h3><p>MyBatis-Plus 提供了对分库分表的支持，方便进行水平拆分和数据库分布式管理。</p><p><strong>分库分表</strong> 是数据库水平扩展（sharding）的一种常见技术，目的是通过将数据分散到多个数据库或表中，以提高数据库的性能、可扩展性和容错能力。在大型分布式系统中，单一数据库可能面临性能瓶颈或者数据量过大导致无法处理的情况，分库分表通过将数据切分成多个部分，分散到多个存储单元中，解决了这些问题。</p><h3 id=11补充>11.补充<a hidden class=anchor aria-hidden=true href=#11补充>#</a></h3><p>先看下面两段代码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>User user <span style=color:#f92672>=</span> query().<span style=color:#a6e22e>eq</span>(<span style=color:#e6db74>&#34;phone&#34;</span>, phone).<span style=color:#a6e22e>one</span>();
</span></span><span style=display:flex><span>List<span style=color:#f92672>&lt;</span>Blog<span style=color:#f92672>&gt;</span> blogs <span style=color:#f92672>=</span> query().<span style=color:#a6e22e>in</span>(<span style=color:#e6db74>&#34;id&#34;</span>, ids).<span style=color:#a6e22e>last</span>(<span style=color:#e6db74>&#34;ORDER BY FIELD(id,&#34;</span> <span style=color:#f92672>+</span> idStr <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;)&#34;</span>).<span style=color:#a6e22e>list</span>();
</span></span></code></pre></div><p>虽然这两段代码调用了 <code>query()</code> 方法，但是 <strong>它们查询的是不同的数据库表</strong>，这主要是通过 <strong><code>query()</code> 方法所在的服务类</strong> 来决定的。</p><ol><li><strong><code>query()</code> 方法所在的服务类</strong></li></ol><p>在 MyBatis-Plus 中，<code>query()</code> 方法是 <code>IService&lt;T></code> 接口中的一个默认方法，它实际上是通过 <code>BaseMapper</code> 执行数据库查询操作。因此，<strong><code>query()</code> 方法是基于当前实例的 <code>BaseMapper</code> 来执行查询的</strong>。不同的服务类会使用不同的实体类和 <code>BaseMapper</code>，从而查询不同的数据库表。</p><ul><li><strong><code>User user = query().eq("phone", phone).one();</code></strong><ul><li>假设 <code>query()</code> 方法是 <code>UserService</code> 类中的方法，这时 <code>UserService</code> 会注入 <code>UserMapper</code>，而 <code>UserMapper</code> 是与 <code>user</code> 表进行交互的。</li><li>在 <code>query()</code> 方法调用时，<code>BaseMapper</code>（<strong>这里是 <code>UserMapper</code></strong>）会执行对应 <code>user</code> 表的查询。</li></ul></li><li><strong><code>List&lt;Blog> blogs = query().in("id", ids).last("ORDER BY FIELD(id," + idStr + ")").list();</code></strong><ul><li>同样，假设这行代码是在 <code>BlogService</code> 类中调用的 <code>query()</code>，那么此时 <code>query()</code> 返回的就是与 <code>Blog</code> 实体相关联的 <code>BlogMapper</code>。</li><li><code>BlogMapper</code> 会执行对 <code>blog</code> 表的查询。</li></ul></li></ul><ol start=2><li><strong><code>BaseMapper</code> 和 <code>query()</code> 方法的关联</strong></li></ol><p>每个实体类（如 <code>User</code>、<code>Blog</code>）通常会有一个对应的 <strong>Mapper</strong>，该 <strong>Mapper</strong> 是通过 <code>BaseMapper&lt;T></code> 进行扩展的，它提供了常用的 CRUD 操作。而 <code>IService&lt;T></code> 接口中的 <code>query()</code> 方法依赖于 <code>BaseMapper</code> 来执行实际的查询操作。</p><ul><li><strong><code>BaseMapper&lt;T></code></strong>：提供了常用的数据库操作方法，例如 <code>selectList()</code>, <code>selectOne()</code>, <code>selectById()</code> 等。</li><li><strong><code>query()</code> 方法</strong>：返回一个 <code>QueryChainWrapper</code>，用于构建查询条件，最终会调用对应的 <code>BaseMapper</code>（如 <code>UserMapper</code> 或 <code>BlogMapper</code>）执行查询。</li></ul><ol start=3><li><strong>如何判断查询哪个数据库？</strong></li></ol><p>MyBatis-Plus 在执行查询时是通过 <strong><code>BaseMapper</code></strong> 来决定的，具体如下：</p><ul><li><strong><code>UserService</code> 类</strong>：<ul><li>如果 <code>query()</code> 方法在 <code>UserService</code> 中被调用，那么 <code>UserService</code> 的 <code>BaseMapper</code> 就是 <code>UserMapper</code>，<code>UserMapper</code> 与 <code>user</code> 表对应，查询将发生在 <code>user</code> 表中。</li><li>这里的 <code>query()</code> 方法调用的是 <code>UserMapper</code> 的方法。</li></ul></li><li><strong><code>BlogService</code> 类</strong>：<ul><li>如果 <code>query()</code> 方法在 <code>BlogService</code> 中被调用，那么 <code>BlogService</code> 的 <code>BaseMapper</code> 就是 <code>BlogMapper</code>，<code>BlogMapper</code> 与 <code>blog</code> 表对应，查询将发生在 <code>blog</code> 表中。</li><li>这里的 <code>query()</code> 方法调用的是 <code>BlogMapper</code> 的方法。</li></ul></li></ul><p>每个服务类（如 <code>UserService</code>、<code>BlogService</code>）都具有自己的 <code>BaseMapper</code>，而 <code>BaseMapper</code> 的 <code>selectList()</code>、<code>selectOne()</code> 等方法会查询不同的数据库表。</p></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://yukipedia.cn/>YUKIPEDIA's blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>